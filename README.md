# Sales-Target

## プログラムの概要
数店舗の売上目標をエクセルシートとして作成する際、その作業を自動化するプログラムです。
エクセルシート（形式はxlsx）を読み込んで目標値を入力すると、自動計算して、かつ新しいエクセルシートの生成ができます。

このプログラムを使って作業する流れとしては、

1.エクセルシートを読み込み
2.参考にしたい月（年、月）を入力
3.その年月の売上データを表示
4.目標単価と客数予想を入力
5.ひと月分の売上予測が算出される

のようになっています。
Sheet.js(https://github.com/SheetJS/sheetjs)を使用。

## 使用するための条件
読み込むエクセルシートに必要な条件（読み込むカラム名はimport.js(createShopInstance関数)で調整可能）
・取引ID（各取引を一意に識別するID）カラムがある。※
・合計（一取引における合計金額）カラムがあること。※
・店舗IDがあること。
　　ただし、配列に格納するため、０からカウントアップするIDであることが好ましい。（describe.jsで作成している）
・1列ににまとまっている、取引日時カラムがあること。
・取消区分があること。（区分がない場合は、すべてエクセル上で0に設定。）

※"日時"と"商品"をベースに、エクセルの各行が作成されていても（取引IDが同じ行があっても）大丈夫、ということ。

祝日の設定をしたい場合は、googleCalendarから日本の祝日に関するAPI KEYを取得し、calendar.jsに設定してください。
また、特別な日を感謝デーとして設定しています。不必要な場合はそれぞれのjsでコメントアウトか消去をしてください。

## 計算に関して
以下、参考月をX、算出月をYとして説明します。また"各曜日"には、特別な日としての感謝デーを含みます。

###1.計算する上での指数
Xにおける「各曜日、一日あたりの平均客数指数、平均単価指数を計算。
Y月中に含まれる各曜日の日数と売上目標値から、Y月用に指数を調整します。

###2.特殊曜日（感謝デー、祝日）に関しての指数調整
指数をY月用に変換する上で、特殊曜日の指数は、平日または休日の指数からの倍率を計算し、
それを平日または休日の指数にかけて換算するようにしています。
またこの計算に関して、感謝デーと祝日が被った場合の優先度は感謝デーのほうが大きく、
感謝デーが祝日の場合は、休日指数を使って計算することとしています。
